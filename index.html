<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
  <title>Advanced Person Identifying System â€” Hacker Vibe Animated</title>
  <link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap" rel="stylesheet">
  <style>
    *{box-sizing:border-box;}
    body{font-family:'Share Tech Mono',monospace;margin:0;background:#0f0f0f;color:#00ff99;display:flex;flex-direction:column;align-items:center;padding:10px;overflow-x:hidden;}
    .card{background:rgba(0,0,0,0.7);border:1px solid #00ff99;border-radius:12px;padding:16px;box-shadow:0 0 20px #00ff99;animation:fadeIn 1s ease-in;width:95%;max-width:1000px;margin-bottom:20px;position:relative;overflow:hidden;}
    #area{display:flex;flex-direction:column;gap:16px;align-items:center;}
    video, canvas {width:100%;max-width:480px;height:auto;border-radius:8px;background:#000;object-fit:cover;box-shadow:0 0 15px #00ff99;}
    .controls{display:flex;flex-wrap:wrap;gap:8px;justify-content:center;margin-top:8px;}
    button{padding:10px;border-radius:8px;border:1px solid #00ff99;background:rgba(0,0,0,0.6);color:#00ff99;cursor:pointer;transition:0.3s;flex:1 1 120px;}
    button:hover{background:#00ff33;color:#000;transform:scale(1.05);box-shadow:0 0 15px #00ff33;}
    input{padding:8px;border-radius:6px;border:1px solid #00ff33;background:#001100;color:#0f0;flex:1 1 120px;}
    small{color:#0f0;display:block;text-align:center;margin-top:4px;}
    #profiles{max-height:300px;overflow:auto;margin-top:8px}
    .profile{padding:8px;border-radius:6px;background:rgba(0,255,153,0.1);margin-bottom:6px;display:flex;justify-content:space-between;align-items:center;animation:slideIn 0.5s ease-in;}
    .virtualFace{width:100%;max-width:200px;height:auto;background:#001100;border-radius:12px;box-shadow:0 0 15px #00ff33;margin:0 auto;}

    /* Hacker vibe animations */
    @keyframes fadeIn{from{opacity:0;}to{opacity:1;}}
    @keyframes slideIn{from{transform:translateX(-100%);}to{transform:translateX(0);}}
    @keyframes glitch {0% {text-shadow: 2px 0 #0f0, -2px 0 #00ff33;} 20% {text-shadow: -2px 0 #0f0, 2px 0 #00ff33;} 40% {text-shadow: 1px 0 #0f0, -1px 0 #00ff33;} 60% {text-shadow: -1px 0 #0f0, 1px 0 #00ff33;} 80% {text-shadow: 2px 0 #0f0, -2px 0 #00ff33;} 100% {text-shadow: none;}}

    /* Particle effects */
    canvas.particles{position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:none;}

    @media(min-width:700px){
      #area{flex-direction:row;align-items:flex-start;}
      .card{margin-bottom:0;}
      .controls{justify-content:flex-start;}
    }
  </style>
</head>
<body>
  <div class="card" id="area">
    <canvas class="particles" id="particles"></canvas>
    <div style="flex:1;position:relative;z-index:1;">
      <video id="video" autoplay muted playsinline></video>
      <canvas id="overlay"></canvas>
      <div class="controls">
        <button id="btnStart">Start Camera</button>
        <button id="btnScan">Scan & Match</button>
        <button id="btnSave">Scan & Save New</button>
        <input id="nameInput" placeholder="name (optional)" />
      </div>
      <small>Tip: allow camera, then click Scan or Scan & Save. Models load once at start.</small>
    </div>

    <div style="flex:1;display:flex;flex-direction:column;align-items:center;position:relative;z-index:1;">
      <div class="card" style="width:100%;margin-bottom:12px;">
        <h3>Match Result</h3>
        <div id="result">No scans yet.</div>
        <h4 style="margin-top:12px">Virtual Face</h4>
        <canvas id="virtual" class="virtualFace"></canvas>
      </div>

      <div class="card" style="width:100%;">
        <h3>Saved Profiles</h3>
        <div id="profiles"></div>
        <button id="clearAll">Clear All Profiles</button>
      </div>
    </div>
  </div>

  <script defer src="https://unpkg.com/face-api.js@0.22.2/dist/face-api.min.js"></script>
  <script>
    // Particle system
    const particleCanvas = document.getElementById('particles');
    const pctx = particleCanvas.getContext('2d');
    particleCanvas.width = particleCanvas.offsetWidth;
    particleCanvas.height = particleCanvas.offsetHeight;
    const particles=[];
    for(let i=0;i<100;i++) particles.push({x:Math.random()*particleCanvas.width, y:Math.random()*particleCanvas.height, r:Math.random()*2+1, dx:(Math.random()-0.5)*0.5, dy:(Math.random()-0.5)*0.5});
    function animateParticles(){
      pctx.clearRect(0,0,particleCanvas.width,particleCanvas.height);
      particles.forEach(p=>{
        p.x+=p.dx; p.y+=p.dy;
        if(p.x<0||p.x>particleCanvas.width)p.dx*=-1;
        if(p.y<0||p.y>particleCanvas.height)p.dy*=-1;
        pctx.fillStyle='#00ff33'; pctx.beginPath(); pctx.arc(p.x,p.y,p.r,0,Math.PI*2); pctx.fill();
      });
      requestAnimationFrame(animateParticles);
    }
    animateParticles();

    // Face recognition code
    const MODEL_URL = 'https://justadudewhohacks.github.io/face-api.js/models';
    const MATCH_THRESHOLD = 0.55;
    const video = document.getElementById('video');
    const overlay = document.getElementById('overlay');
    const ctx = overlay.getContext('2d');
    const btnStart = document.getElementById('btnStart');
    const btnScan = document.getElementById('btnScan');
    const btnSave = document.getElementById('btnSave');
    const nameInput = document.getElementById('nameInput');
    const resultDiv = document.getElementById('result');
    const profilesDiv = document.getElementById('profiles');
    const virtualCanvas = document.getElementById('virtual');
    const vctx = virtualCanvas.getContext('2d');
    const clearAll = document.getElementById('clearAll');
    let stream=null, modelsLoaded=false;
    
    // ... keep the rest of the previous JS for face-api, scanning, virtual face, etc.

    // Make sure particleCanvas resizes on window resize
    window.addEventListener('resize',()=>{particleCanvas.width = particleCanvas.offsetWidth; particleCanvas.height = particleCanvas.offsetHeight;});
  </script>
</body>
</html>
